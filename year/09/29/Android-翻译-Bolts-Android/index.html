<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="[TOC] Github查看英文版 Bolts是一个为了方便移动APP开发而设计的低级库集合。Bolts由Parse和Facebook设计用来我们内部使用的，现在我们决定开源这些库让其他人也可以用。使用这些库不需要添加使用任何Parse的服务，也不需要拥有一个Parse或者Facebook的开发者账号。 Bolts包含：  “Tasks”,它使得复杂的异步代码更易于管理。一个任务类似于JavaS">
<meta property="og:type" content="article">
<meta property="og:title" content="Bolts">
<meta property="og:url" content="https://www.sanqis.com/blog/year/09/29/Android-翻译-Bolts-Android/index.html">
<meta property="og:site_name" content="今夕何夕">
<meta property="og:description" content="[TOC] Github查看英文版 Bolts是一个为了方便移动APP开发而设计的低级库集合。Bolts由Parse和Facebook设计用来我们内部使用的，现在我们决定开源这些库让其他人也可以用。使用这些库不需要添加使用任何Parse的服务，也不需要拥有一个Parse或者Facebook的开发者账号。 Bolts包含：  “Tasks”,它使得复杂的异步代码更易于管理。一个任务类似于JavaS">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://img.shields.io/travis/BoltsFramework/Bolts-Android/master.svg?style=flat">
<meta property="og:image" content="https://coveralls.io/repos/BoltsFramework/Bolts-Android/badge.svg?branch=master&service=github">
<meta property="og:image" content="https://img.shields.io/maven-central/v/com.parse.bolts/bolts-tasks.svg?label=bolts-tasks&style=flat">
<meta property="og:image" content="https://img.shields.io/maven-central/v/com.parse.bolts/bolts-applinks.svg?label=bolts-applinks&style=flat">
<meta property="og:image" content="https://img.shields.io/badge/license-BSD-lightgrey.svg?style=flat">
<meta property="og:updated_time" content="2017-10-12T05:57:04.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bolts">
<meta name="twitter:description" content="[TOC] Github查看英文版 Bolts是一个为了方便移动APP开发而设计的低级库集合。Bolts由Parse和Facebook设计用来我们内部使用的，现在我们决定开源这些库让其他人也可以用。使用这些库不需要添加使用任何Parse的服务，也不需要拥有一个Parse或者Facebook的开发者账号。 Bolts包含：  “Tasks”,它使得复杂的异步代码更易于管理。一个任务类似于JavaS">
<meta name="twitter:image" content="http://img.shields.io/travis/BoltsFramework/Bolts-Android/master.svg?style=flat">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://www.sanqis.com/blog/year/09/29/Android-翻译-Bolts-Android/"/>





  <title>Bolts | 今夕何夕</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">今夕何夕</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">博客</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />
            
            日程表
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.sanqis.com/blog/year/09/29/Android-翻译-Bolts-Android/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jadyli">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="今夕何夕">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Bolts</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-29T17:47:58+08:00">
                2017-09-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><a href="https://travis-ci.org/BoltsFramework/Bolts-Android" target="_blank" rel="external"><img src="http://img.shields.io/travis/BoltsFramework/Bolts-Android/master.svg?style=flat" alt="Build Status"></a><br><a href="https://coveralls.io/github/BoltsFramework/Bolts-Android?branch=master" target="_blank" rel="external"><img src="https://coveralls.io/repos/BoltsFramework/Bolts-Android/badge.svg?branch=master&amp;service=github" alt="Coverage Status"></a><br><a href="https://maven-badges.herokuapp.com/maven-central/com.parse.bolts/bolts-tasks" target="_blank" rel="external"><img src="https://img.shields.io/maven-central/v/com.parse.bolts/bolts-tasks.svg?label=bolts-tasks&amp;style=flat" alt="Maven Central"></a><br><a href="https://maven-badges.herokuapp.com/maven-central/com.parse.bolts/bolts-applinks" target="_blank" rel="external"><img src="https://img.shields.io/maven-central/v/com.parse.bolts/bolts-applinks.svg?label=bolts-applinks&amp;style=flat" alt="Maven Central"></a><br><a href="https://github.com/BoltsFramework/Bolts-Android/blob/master/LICENSE" target="_blank" rel="external"><img src="https://img.shields.io/badge/license-BSD-lightgrey.svg?style=flat" alt="License"></a></p>
<p>[TOC]</p>
<p><a href="https://github.com/Jadyli/Bolts-Android/blob/master/README_CN.md" target="_blank" rel="external">Github查看</a><br><a href="https://github.com/BoltsFramework/Bolts-Android/blob/master/README.md" target="_blank" rel="external">英文版</a></p>
<p>Bolts是一个为了方便移动APP开发而设计的低级库集合。Bolts由Parse和Facebook设计用来我们内部使用的，现在我们决定开源这些库让其他人也可以用。使用这些库不需要添加使用任何Parse的服务，也不需要拥有一个Parse或者Facebook的开发者账号。</p>
<p>Bolts包含：</p>
<ul>
<li>“Tasks”,它使得复杂的异步代码更易于管理。一个任务类似于JavaScript的Promise，但是它可以用于ios和Android。</li>
<li>一个<a href="http://www.applinks.org" target="_blank" rel="external">App Links protocol</a>的实现，帮助您链接到其他应用程序中的内容，并处理传入的多层链接。</li>
</ul>
<p>想了解更多信息，请参考<a href="http://boltsframework.github.io/Bolts-Android/" target="_blank" rel="external">Bolts Android API Reference</a>。</p>
<h1 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h1><p>下载<a href="https://search.maven.org/remote_content?g=com.parse.bolts&amp;a=bolts-tasks&amp;v=LATEST" target="_blank" rel="external">最新的jar包</a>或者在Gradle中定义：</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">dependencies &#123;</div><div class="line">  compile <span class="string">'com.parse.bolts:bolts-tasks:1.4.0'</span></div><div class="line">  compile <span class="string">'com.parse.bolts:bolts-applinks:1.4.0'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>开发版本的快照可以在<a href="https://oss.sonatype.org/content/repositories/snapshots/" target="_blank" rel="external">Sonatype的<code>snapshots</code>仓库</a>找到。</p>
<h1 id="Tasks"><a href="#Tasks" class="headerlink" title="Tasks"></a>Tasks</h1><p>要创建一个真正的响应式Android程序，你必须让需要耗时操作脱离UI线程，并且要小心翼翼地避免阻塞UI线程。为了更容易得实现这个操作，我们增加了一个叫<code>Task</code>的类。一个<code>Task</code>代表一个异步操作。一个<code>Task</code>通常由一个异步方法返回并且拥有可以继续对这个<code>Task</code>进行操作的能力。当一个<code>Task</code>从方法中返回时已经开始执行它的工作了。一个<code>Task</code>并不与特定的线程模型有关：它代表正在做的工作，而不是在哪里做。相比于<code>callbacks</code>和<code>AsyncTask</code>之类的其他异步编程方法，<code>Tasks</code>拥有很多优势：</p>
<ul>
<li>只消耗少量的系统资源， 因为当等待其他<code>Task</code>的时候并不会占用线程。</li>
<li>在一条线上执行多个任务，而不是像只使用<code>callbacks</code>一样创建<code>金字塔</code>代码。</li>
<li><code>Task</code>是完全可组合的，允许你执行分支，并行和复杂的错误处理，而没有很多命名回调的<code>意大利面条</code>式代码。</li>
<li>您可以按照执行的顺序排列基于任务的代码，而不必将其分散到不同的回调函数中。</li>
</ul>
<p>这个文档的例子假定已经有了一些名为<code>saveAsync</code>和<code>findAsync</code>的异步解析方法，它们返回一个<code>Task</code>。在后面的部分我们会教你如何自定义这些方法。</p>
<h2 id="continueWith-方法"><a href="#continueWith-方法" class="headerlink" title="continueWith 方法"></a><code>continueWith</code> 方法</h2><p>每个<code>Task</code>都有个叫<code>continueWith</code>的方法，它接收一个<code>Continuation</code>对象。<code>Continuation</code>是一个只有一个<code>then</code>方法的接口，<code>then</code>方法在<code>Task</code>结束时调用。你能在<code>then</code>方法中检查任务是否成功，也可以拿到任务执行的结果。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">saveAsync(obj).continueWith(<span class="keyword">new</span> Continuation&lt;ParseObject, Void&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Void <span class="title">then</span><span class="params">(Task&lt;ParseObject&gt; task)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    <span class="keyword">if</span> (task.isCancelled()) &#123;</div><div class="line">      <span class="comment">// 取消了保存</span></div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (task.isFaulted()) &#123;</div><div class="line">      <span class="comment">// 保存失败</span></div><div class="line">      Exception error = task.getError();</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="comment">// 保存成功</span></div><div class="line">      ParseObject object = task.getResult();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><code>Task</code>使用了Java的泛型，是强类型的，所以在开始使用的时候要小心一点以免出现语法错误。让我们通过一个例子来更进一步地看下这些类型吧。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> 异步获取一个字符串。</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">public</span> Task&lt;String&gt; <span class="title">getStringAsync</span><span class="params">()</span> </span>&#123;</div><div class="line">  <span class="comment">//我们假设getIntAsync()方法返回一个Task&lt;Integer&gt;。</span></div><div class="line">  <span class="keyword">return</span> getIntAsync().continueWith(</div><div class="line">    <span class="comment">//这个Continuation接收一个Integer作为输入，提供一个String作为输出。</span></div><div class="line">    <span class="comment">//它必须接收一个Integer因为这是上一个Task的返回值。</span></div><div class="line">    <span class="keyword">new</span> Continuation&lt;Integer, String&gt;() &#123;</div><div class="line">      <span class="comment">//为了方便将getIntAsync()返回的Task传递给 "then"。</span></div><div class="line">      <span class="function"><span class="keyword">public</span> String <span class="title">then</span><span class="params">(Task&lt;Integer&gt; task)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">        Integer number = task.getResult();</div><div class="line">        <span class="keyword">return</span> String.format(<span class="string">"%d"</span>, Locale.US, number);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>有很多情况是你只需要处理成功回调并且晚点处理失败和取消，可以使用<code>onSuccess</code>方法替代<code>continueWith</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">saveAsync(obj).onSuccess(<span class="keyword">new</span> Continuation&lt;ParseObject, Void&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Void <span class="title">then</span><span class="params">(Task&lt;ParseObject&gt; task)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    <span class="comment">// 对象保存成功</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="链式任务"><a href="#链式任务" class="headerlink" title="链式任务"></a>链式任务</h2><p><code>Task</code>有点神奇，因为它让你不用嵌套就能将它们串联在一起。如果你使用<code>continueWithTask</code>而不是<code>continueWith</code>，你就能返回一个新的<code>Task</code>。这个由<code>continueWithTask</code>返回的<code>Task</code>直到内层的<code>continueWithTask</code>返回了新的<code>Task</code>才会被认为完成了。这可以让你执行多个操作，却不用忍受使用回调产生的<code>金字塔</code>代码。类似的，<code>onSuccessTask</code>是<code>onSuccess</code>的返回<code>Task</code>版本。因此，使用<code>continueWith</code>/<code>onSuccess</code>做更多的同步工作，或者使用<code>continueWithTask</code>/<code>onSuccessTask</code>做更多的异步工作。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">final</span> ParseQuery&lt;ParseObject&gt; query = ParseQuery.getQuery(<span class="string">"Student"</span>);</div><div class="line">query.orderByDescending(<span class="string">"gpa"</span>);</div><div class="line">findAsync(query).onSuccessTask(<span class="keyword">new</span> Continuation&lt;List&lt;ParseObject&gt;, Task&lt;ParseObject&gt;&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Task&lt;ParseObject&gt; <span class="title">then</span><span class="params">(Task&lt;List&lt;ParseObject&gt;&gt; task)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    List&lt;ParseObject&gt; students = task.getResult();</div><div class="line">    students.get(<span class="number">0</span>).put(<span class="string">"valedictorian"</span>, <span class="keyword">true</span>);</div><div class="line">    <span class="keyword">return</span> saveAsync(students.get(<span class="number">0</span>));</div><div class="line">  &#125;</div><div class="line">&#125;).onSuccessTask(<span class="keyword">new</span> Continuation&lt;ParseObject, Task&lt;List&lt;ParseObject&gt;&gt;&gt;() &#123;</div><div class="line">  <span class="keyword">public</span> Task&lt;List&lt;ParseObject&gt;&gt; then(Task&lt;ParseObject&gt; task) <span class="keyword">throws</span> Exception &#123;</div><div class="line">    ParseObject valedictorian = task.getResult();</div><div class="line">    <span class="keyword">return</span> findAsync(query);</div><div class="line">  &#125;</div><div class="line">&#125;).onSuccessTask(<span class="keyword">new</span> Continuation&lt;List&lt;ParseObject&gt;, Task&lt;ParseObject&gt;&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Task&lt;ParseObject&gt; <span class="title">then</span><span class="params">(Task&lt;List&lt;ParseObject&gt;&gt; task)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    List&lt;ParseObject&gt; students = task.getResult();</div><div class="line">    students.get(<span class="number">1</span>).put(<span class="string">"salutatorian"</span>, <span class="keyword">true</span>);</div><div class="line">    <span class="keyword">return</span> saveAsync(students.get(<span class="number">1</span>));</div><div class="line">  &#125;</div><div class="line">&#125;).onSuccess(<span class="keyword">new</span> Continuation&lt;ParseObject, Void&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Void <span class="title">then</span><span class="params">(Task&lt;ParseObject&gt; task)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    <span class="comment">// 所有任务完成</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><p>在选择是否调用<code>continueWith</code>或者<code>onSuccess</code>时要小心一点，你可以控制错误如何在你的应用中传递。使用<code>continueWith</code>来传递错误或者处理错误。你可以把失败的任务看做抛出一个异常。事实上，你可以在continuation里面抛出一个异常，然后会产生一个与此相关的<code>Task</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">final</span> ParseQuery&lt;ParseObject&gt; query = ParseQuery.getQuery(<span class="string">"Student"</span>);</div><div class="line">query.orderByDescending(<span class="string">"gpa"</span>);</div><div class="line">findAsync(query).onSuccessTask(<span class="keyword">new</span> Continuation&lt;List&lt;ParseObject&gt;, Task&lt;ParseObject&gt;&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Task&lt;ParseObject&gt; <span class="title">then</span><span class="params">(Task&lt;List&lt;ParseObject&gt;&gt; task)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    List&lt;ParseObject&gt; students = task.getResult();</div><div class="line">    students.get(<span class="number">0</span>).put(<span class="string">"valedictorian"</span>, <span class="keyword">true</span>);</div><div class="line">    <span class="comment">// 强制把回调变成异常。</span></div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"There was an error."</span>);</div><div class="line">  &#125;</div><div class="line">&#125;).onSuccessTask(<span class="keyword">new</span> Continuation&lt;ParseObject, Task&lt;List&lt;ParseObject&gt;&gt;&gt;() &#123;</div><div class="line">  <span class="keyword">public</span> Task&lt;List&lt;ParseObject&gt;&gt; then(Task&lt;ParseObject&gt; task) <span class="keyword">throws</span> Exception &#123;</div><div class="line">    <span class="comment">// 跳过这个 continuation。</span></div><div class="line">    ParseObject valedictorian = task.getResult();</div><div class="line">    <span class="keyword">return</span> findAsync(query);</div><div class="line">  &#125;</div><div class="line">&#125;).continueWithTask(<span class="keyword">new</span> Continuation&lt;List&lt;ParseObject&gt;, Task&lt;ParseObject&gt;&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Task&lt;ParseObject&gt; <span class="title">then</span><span class="params">(Task&lt;List&lt;ParseObject&gt;&gt; task)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    <span class="keyword">if</span> (task.isFaulted()) &#123;</div><div class="line">      <span class="comment">//错误处理器将被调用。</span></div><div class="line">      <span class="comment">//这个异常会变成 "There was an error"。</span></div><div class="line">      <span class="comment">//我们通过返回一个新的值来处理异常</span></div><div class="line">      <span class="comment">//这个任务完成时的返回值是null。</span></div><div class="line">      <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// 这里也会跳过</span></div><div class="line">    List&lt;ParseObject&gt; students = task.getResult();</div><div class="line">    students.get(<span class="number">1</span>).put(<span class="string">"salutatorian"</span>, <span class="keyword">true</span>);</div><div class="line">    <span class="keyword">return</span> saveAsync(students.get(<span class="number">1</span>));</div><div class="line">  &#125;</div><div class="line">&#125;).onSuccess(<span class="keyword">new</span> Continuation&lt;ParseObject, Void&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Void <span class="title">then</span><span class="params">(Task&lt;ParseObject&gt; task)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    <span class="comment">//所有的操作都完成啦！这里被调用了。</span></div><div class="line">    <span class="comment">//这个任务的结果是null</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>在一串成功回调的最后加一个错误处理器，这样比较方便。</p>
<h2 id="创建任务"><a href="#创建任务" class="headerlink" title="创建任务"></a>创建任务</h2><p>当你开始使用时，你只需使用<code>findAsync</code>或<code>saveAsync</code>等方法返回的<code>Task</code>。但是，对于更高级的场景，你可能想要创建你自己的<code>Task</code>。你可以通过创建一个<code>TaskCompletionSource</code>来实现。你可以通过该对象创建一个新的<code>Task</code>，并控制是否将其标记为已完成或已取消。在你创建了一个<code>Task</code>后，你需要调用<code>setResult</code>，<code>setError</code>，或者<code>setCancelled</code>来触发它的continuation.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> Task&lt;String&gt; <span class="title">succeedAsync</span><span class="params">()</span> </span>&#123;</div><div class="line">  TaskCompletionSource&lt;String&gt; successful = <span class="keyword">new</span> TaskCompletionSource&lt;&gt;();</div><div class="line">  successful.setResult(<span class="string">"The good result."</span>);</div><div class="line">  <span class="keyword">return</span> successful.getTask();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> Task&lt;String&gt; <span class="title">failAsync</span><span class="params">()</span> </span>&#123;</div><div class="line">  TaskCompletionSource&lt;String&gt; failed = <span class="keyword">new</span> TaskCompletionSource&lt;&gt;();</div><div class="line">  failed.setError(<span class="keyword">new</span> RuntimeException(<span class="string">"An error message."</span>));</div><div class="line">  <span class="keyword">return</span> failed.getTask();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果你在<code>Task</code>创建时就知道<code>Task</code>执行的结果，你可以使用一些更简便的方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Task&lt;String&gt; successful = Task.forResult(<span class="string">"The good result."</span>);</div><div class="line"></div><div class="line">Task&lt;String&gt; failed = Task.forError(<span class="keyword">new</span> RuntimeException(<span class="string">"An error message."</span>));</div></pre></td></tr></table></figure>
<h2 id="创建异步方法"><a href="#创建异步方法" class="headerlink" title="创建异步方法"></a>创建异步方法</h2><p>使用这些工具很容易创建自己的带返回<code>Task</code>的异步方法。比如你能更简单地定义<code>fetchAsync</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> Task&lt;ParseObject&gt; <span class="title">fetchAsync</span><span class="params">(ParseObject obj)</span> </span>&#123;</div><div class="line">  <span class="keyword">final</span> TaskCompletionSource&lt;ParseObject&gt; tcs = <span class="keyword">new</span> TaskCompletionSource&lt;&gt;();</div><div class="line">  obj.fetchInBackground(<span class="keyword">new</span> GetCallback() &#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">done</span><span class="params">(ParseObject object, ParseException e)</span> </span>&#123;</div><div class="line">     <span class="keyword">if</span> (e == <span class="keyword">null</span>) &#123;</div><div class="line">       tcs.setResult(object);</div><div class="line">     &#125; <span class="keyword">else</span> &#123;</div><div class="line">       tcs.setError(e);</div><div class="line">     &#125;</div><div class="line">   &#125;</div><div class="line">  &#125;);</div><div class="line">  <span class="keyword">return</span> tcs.getTask();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>同样地，创建<code>saveAsync</code>，<code>findAsync</code>或<code>deleteAsync</code>也很容易。我们也提供了一些便捷的方法帮助你从直接代码块创建<code>Task</code>。<code>callInBackground</code>在我们的后台线程池运行一个<code>Task</code>，而<code>call</code>则是尝试立即执行它的代码块。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Task.callInBackground(<span class="keyword">new</span> Callable&lt;Void&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Void <span class="title">call</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="comment">// 做一堆东西。</span></div><div class="line">  &#125;</div><div class="line">&#125;).continueWith(...);</div></pre></td></tr></table></figure>
<h2 id="顺序任务"><a href="#顺序任务" class="headerlink" title="顺序任务"></a>顺序任务</h2><p>当你想要按顺序执行一系列的异步操作时，Task是非常方便的，每个操作都会等待上一个操作完成。比如说，想象你要删除所有你博客中的评论。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">ParseQuery&lt;ParseObject&gt; query = ParseQuery.getQuery(<span class="string">"Comments"</span>);</div><div class="line">query.whereEqualTo(<span class="string">"post"</span>, <span class="number">123</span>);</div><div class="line"></div><div class="line">findAsync(query).continueWithTask(<span class="keyword">new</span> Continuation&lt;List&lt;ParseObject&gt;, Task&lt;Void&gt;&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Task&lt;Void&gt; <span class="title">then</span><span class="params">(Task&lt;List&lt;ParseObject&gt;&gt; results)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    <span class="comment">//创建一个简单的已完成task作为基础案例。</span></div><div class="line">    Task&lt;Void&gt; task = Task.forResult(<span class="keyword">null</span>);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">final</span> ParseObject result : results) &#123;</div><div class="line">      <span class="comment">//对于每个item，扩展一个带删除item方法的task。</span></div><div class="line">      task = task.continueWithTask(<span class="keyword">new</span> Continuation&lt;Void, Task&lt;Void&gt;&gt;() &#123;</div><div class="line">        <span class="function"><span class="keyword">public</span> Task&lt;Void&gt; <span class="title">then</span><span class="params">(Task&lt;Void&gt; ignored)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">          <span class="comment">//返回一个task,当删除完成时task会被标记为结束</span></div><div class="line">          <span class="keyword">return</span> deleteAsync(result);</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> task;</div><div class="line">  &#125;</div><div class="line">&#125;).continueWith(<span class="keyword">new</span> Continuation&lt;Void, Void&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Void <span class="title">then</span><span class="params">(Task&lt;Void&gt; ignored)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    <span class="comment">//所有评论都删除了</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="并行任务"><a href="#并行任务" class="headerlink" title="并行任务"></a>并行任务</h2><p>你也可以使用<code>whenAll</code>方法来并行执行几个<code>Task</code>。你可以一次性开始多个操作并且使用<code>Task.whenAll</code>来创建一个新的<code>Task</code>，当所有输入的<code>Task</code>都完成时，这个<code>Task</code>将被标记为完成。<br>只有当所有传入的<code>Task</code>都成功之后这个新<code>Task</code>才算成功。虽然并行执行操作比顺序执行更快，但是可能会消耗更多的系统资源和带宽。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">ParseQuery&lt;ParseObject&gt; query = ParseQuery.getQuery(<span class="string">"Comments"</span>);</div><div class="line">query.whereEqualTo(<span class="string">"post"</span>, <span class="number">123</span>);</div><div class="line"></div><div class="line">findAsync(query).continueWithTask(<span class="keyword">new</span> Continuation&lt;List&lt;ParseObject&gt;, Task&lt;Void&gt;&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Task&lt;Void&gt; <span class="title">then</span><span class="params">(Task&lt;List&lt;ParseObject&gt;&gt; results)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    <span class="comment">// 将每个删除的任务收集到数组中。</span></div><div class="line">    ArrayList&lt;Task&lt;Void&gt;&gt; tasks = <span class="keyword">new</span> ArrayList&lt;Task&lt;Void&gt;&gt;();</div><div class="line">    <span class="keyword">for</span> (ParseObject result : results) &#123;</div><div class="line">      <span class="comment">//立即开始删除并且将它的task添加到列表中</span></div><div class="line">      tasks.add(deleteAsync(result));</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// 返回一个新的task，当所有删除操作完成后这个task会被标记为完成</span></div><div class="line">    <span class="keyword">return</span> Task.whenAll(tasks);</div><div class="line">  &#125;</div><div class="line">&#125;).onSuccess(<span class="keyword">new</span> Continuation&lt;Void, Void&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Void <span class="title">then</span><span class="params">(Task&lt;Void&gt; ignored)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    <span class="comment">// 所有的评论都删除了</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="Task-Executors"><a href="#Task-Executors" class="headerlink" title="Task Executors"></a>Task Executors</h2><p>所有的<code>continueWith</code>和<code>onSuccess</code>方法都可以使用一个<code>java.util.concurrent.Executor</code>作为可选的第二个参数。<code>Executor</code>允许你控制continuation的执行方式。<code>Task.call()</code>会调用当前线程的<code>Callable</code>而<code>Task.callInBackground</code>会使用它自己的线程池，但是你也能指定你自己的executor来调度不同的线程。比如你想在特定的线程池执行工作：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="keyword">final</span> Executor NETWORK_EXECUTOR = Executors.newCachedThreadPool();</div><div class="line"><span class="keyword">static</span> <span class="keyword">final</span> Executor DISK_EXECUTOR = Executors.newCachedThreadPool();</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">final</span> Request request = ...</div><div class="line">Task.call(<span class="keyword">new</span> Callable&lt;HttpResponse&gt;() &#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> HttpResponse <span class="title">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    <span class="comment">//工作被指定在NETWORK_EXECUTOR执行</span></div><div class="line">    <span class="keyword">return</span> client.execute(request);</div><div class="line">  &#125;</div><div class="line">&#125;, NETWORK_EXECUTOR).continueWithTask(<span class="keyword">new</span> Continuation&lt;HttpResponse, Task&lt;<span class="keyword">byte</span>[]&gt;&gt;() &#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="keyword">public</span> Task&lt;<span class="keyword">byte</span>[]&gt; then(Task&lt;HttpResponse&gt; task) <span class="keyword">throws</span> Exception &#123;</div><div class="line">    <span class="comment">//由于没有指定executor,这里继续在NETWORK_EXECUTOR上执行</span></div><div class="line">    <span class="keyword">return</span> processResponseAsync(response);</div><div class="line">  &#125;</div><div class="line">&#125;).continueWithTask(<span class="keyword">new</span> Continuation&lt;<span class="keyword">byte</span>[], Task&lt;Void&gt;&gt;() &#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> Task&lt;Void&gt; <span class="title">then</span><span class="params">(Task&lt;<span class="keyword">byte</span>[]&gt; task)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    <span class="comment">//我们不想让磁盘读写阻塞NETWORK_EXECUTOR，所有指定使用DISK_EXECUTOR</span></div><div class="line">    <span class="keyword">return</span> writeToDiskAsync(task.getResult());</div><div class="line">  &#125;</div><div class="line">&#125;, DISK_EXECUTOR);</div></pre></td></tr></table></figure>
<p>一般情况下，像在主线程分发这种，我们提供了默认的Executor，包含<code>Task.UI_THREAD_EXECUTOR</code>和<code>Task.BACKGROUND_EXECUTOR</code>。举个例子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">fetchAsync(object).continueWith(<span class="keyword">new</span> Continuation&lt;ParseObject, Void&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Void <span class="title">then</span><span class="params">(Task&lt;ParseObject&gt; object)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    TextView textView = (TextView)findViewById(R.id.name);</div><div class="line">    textView.setText(object.get(<span class="string">"name"</span>));</div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">  &#125;</div><div class="line">&#125;, Task.UI_THREAD_EXECUTOR);</div></pre></td></tr></table></figure>
<h2 id="捕获变量"><a href="#捕获变量" class="headerlink" title="捕获变量"></a>捕获变量</h2><p>在多个回调中分解代码的一个困难在于它们具有不同的变量作用域。 Java允许函数从外部范围“捕获”变量，但只有当它们被标记为<code>final</code>时，才使它们变得不可变，这是不方便的。 这就是为什么我们添加了另一个便捷的类<code>Capture</code>，它可以让你与回调共享一个变量。只需要调用变量的<code>get</code>和<code>set</code>方法来改变它的值。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//在Task的回调中捕获一个变量</span></div><div class="line"><span class="keyword">final</span> Capture&lt;Integer&gt; successfulSaveCount = <span class="keyword">new</span> Capture&lt;Integer&gt;(<span class="number">0</span>);</div><div class="line"></div><div class="line">saveAsync(obj1).onSuccessTask(<span class="keyword">new</span> Continuation&lt;ParseObject, Task&lt;ParseObject&gt;&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Task&lt;ParseObject&gt; <span class="title">then</span><span class="params">(Task&lt;ParseObject&gt; obj1)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    successfulSaveCount.set(successfulSaveCount.get() + <span class="number">1</span>);</div><div class="line">    <span class="keyword">return</span> saveAsync(obj2);</div><div class="line">  &#125;</div><div class="line">&#125;).onSuccessTask(<span class="keyword">new</span> Continuation&lt;ParseObject, Task&lt;ParseObject&gt;&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Task&lt;ParseObject&gt; <span class="title">then</span><span class="params">(Task&lt;ParseObject&gt; obj2)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    successfulSaveCount.set(successfulSaveCount.get() + <span class="number">1</span>);</div><div class="line">    <span class="keyword">return</span> saveAsync(obj3);</div><div class="line">  &#125;</div><div class="line">&#125;).onSuccessTask(<span class="keyword">new</span> Continuation&lt;ParseObject, Task&lt;ParseObject&gt;&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Task&lt;ParseObject&gt; <span class="title">then</span><span class="params">(Task&lt;ParseObject&gt; obj3)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    successfulSaveCount.set(successfulSaveCount.get() + <span class="number">1</span>);</div><div class="line">    <span class="keyword">return</span> saveAsync(obj4);</div><div class="line">  &#125;</div><div class="line">&#125;).onSuccess(<span class="keyword">new</span> Continuation&lt;ParseObject, Void&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Void <span class="title">then</span><span class="params">(Task&lt;ParseObject&gt; obj4)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    successfulSaveCount.set(successfulSaveCount.get() + <span class="number">1</span>);</div><div class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">  &#125;</div><div class="line">&#125;).continueWith(<span class="keyword">new</span> Continuation&lt;Void, Integer&gt;() &#123;</div><div class="line">  <span class="function"><span class="keyword">public</span> Integer <span class="title">then</span><span class="params">(Task&lt;Void&gt; ignored)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">    <span class="comment">//现在successfulSaveCount中有保存成功的数量</span></div><div class="line">    <span class="keyword">return</span> successfulSaveCount.get();</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="取消Task"><a href="#取消Task" class="headerlink" title="取消Task"></a>取消Task</h2><p>要想取消一个<code>Task</code>,首先创建一个<code>CancellationTokenSource</code>，然后把<code>CancellationTokenSource</code>的响应token传递到你要取消的<code>Task</code>中，然后调用<code>CancellationTokenSource</code>的<code>cancel()</code>方法即可。这将取消任何正在执行的token绑定的<code>Task</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">CancellationTokenSource cts = <span class="keyword">new</span> CancellationTokenSource();</div><div class="line"></div><div class="line">Task&lt;Integer&gt; stringTask = getIntAsync(cts.getToken());</div><div class="line"></div><div class="line">cts.cancel();</div></pre></td></tr></table></figure>
<p>要想使用token来取消一个异步的调用，首先你得修改任务的方法，让它可以接收一个<code>CancellationToken</code>并且使用<code>isCancellationRequested()</code>方法来决定何时停止操作。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> 异步获取`Integer`</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">public</span> Task&lt;Integer&gt; <span class="title">getIntAsync</span><span class="params">(<span class="keyword">final</span> CancellationToken ct)</span> </span>&#123;</div><div class="line">  <span class="comment">// 创建一个任务</span></div><div class="line">  <span class="keyword">final</span> TaskCompletionSource&lt;Integer&gt; tcs = <span class="keyword">new</span> TaskCompletionSource&lt;&gt;();</div><div class="line"></div><div class="line">  <span class="keyword">new</span> Thread() &#123;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">      <span class="comment">// 在开始时检查是否取消</span></div><div class="line">      <span class="keyword">if</span> (ct.isCancellationRequested()) &#123;</div><div class="line">        tcs.setCancelled();</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      <span class="keyword">int</span> result = <span class="number">0</span>;</div><div class="line">      <span class="keyword">while</span> (result &lt; <span class="number">100</span>) &#123;</div><div class="line">        <span class="comment">// 在一个循环中轮询isCancellationRequested</span></div><div class="line">        <span class="keyword">if</span> (ct.isCancellationRequested()) &#123;</div><div class="line">          tcs.setCancelled();</div><div class="line">          <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        result++;</div><div class="line">      &#125;</div><div class="line">      tcs.setResult(result);</div><div class="line">    &#125;</div><div class="line">  &#125;.start();</div><div class="line"></div><div class="line">  <span class="keyword">return</span> tcs.getTask();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="App-Links"><a href="#App-Links" class="headerlink" title="App Links"></a>App Links</h1><p><a href="http://www.applinks.org" target="_blank" rel="external">App Links</a> 提供了一个跨平台的机制让开发者可以为他们的内容定义和发布一个多层链接的scheme，允许其他APP直接连接。不管你是构建一个接收传入链接的还是可能链接到其他app内容的app，Bolts都会提供工具来简化<a href="http://www.applinks.org/documentation" target="_blank" rel="external">App链接协议</a>的实现。</p>
<h2 id="处理App-Link"><a href="#处理App-Link" class="headerlink" title="处理App Link"></a>处理App Link</h2><p>最常见的情况是让你的app可以接收App Link。<br>App Link让你的用户可以在他们的设备上快速访问最丰富的、最原生的内容呈现。Bolts通过提供一系列处理传入<code>Intent</code>的工具来简化处理传入的App Link。</p>
<p>比方说，你可以在你的<code>Activity</code>中使用<code>AppLinks</code>工具类来解析传递过来的<code>Intent</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">  <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line"></div><div class="line">  <span class="comment">//在某种程度上你的AndroidMainifest.xml中的intent filter可能已经被path过滤了一遍</span></div><div class="line"></div><div class="line">  <span class="comment">// 使用App Link中的target URL 来定位内容。</span></div><div class="line">  Uri targetUrl = AppLinks.getTargetUrlFromInboundIntent(getIntent());</div><div class="line">  <span class="keyword">if</span> (targetUrl != <span class="keyword">null</span>) &#123;</div><div class="line">    <span class="comment">//这是被app link启动的activity。</span></div><div class="line"></div><div class="line">    <span class="comment">//targetUrl是外部共享的URL。在大多数情况下，你会在数据中嵌入你的内容标识符</span></div><div class="line">    </div><div class="line">    <span class="comment">//如果你需要访问从你的网站或者app中传到meta标签中的数据，可以在AppLinkData中拿到</span></div><div class="line">    Bundle applinkData = AppLinks.getAppLinkData(getIntent());</div><div class="line">    String id = applinkData.getString(<span class="string">"id"</span>);</div><div class="line">    </div><div class="line">    <span class="comment">//你也可以从AppLinkData中得到referrer data</span></div><div class="line">    Bundle referrerAppData = applinkData.getBundle(<span class="string">"referer_app_link"</span>);</div><div class="line"></div><div class="line">    <span class="comment">//Apps也可以很轻松的检查App Link中的Extras。</span></div><div class="line">    Bundle extras = AppLinks.getAppLinkExtras(getIntent());</div><div class="line">    String fbAccessToken = extras.getString(<span class="string">"fb_access_token"</span>);</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">//不是app链接，你已有的代码放这里</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="导航到一个url"><a href="#导航到一个url" class="headerlink" title="导航到一个url"></a>导航到一个url</h2><p>通过App Link，你的应用程序可以在用户导航到链接时提供最佳用户体验（由接收应用定义）。 Bolts简化了这个过程，自动执行跟踪链接所需的步骤：</p>
<ol>
<li><p>在指定的URL从HTML获取应用链接元数据解析的应用链接</p>
</li>
<li><p>逐步执行与正在使用的设备相关的App Link targets，检查设备上是否存在可以处理targets的应用</p>
</li>
<li><p>如果应用程序存在，请使用指定的al_applink_data构建“Intent”，并导航到“Intent”</p>
</li>
<li><p>否则，请使用指定的原始网址打开浏览器</p>
</li>
</ol>
<p>在最简单的情况下，只需一行代码即可导航到可能具有App Link的URL：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">AppLinkNavigation.navigateInBackground(getContext(), url);</div></pre></td></tr></table></figure>
<h3 id="添加应用和导航数据"><a href="#添加应用和导航数据" class="headerlink" title="添加应用和导航数据"></a>添加应用和导航数据</h3><p>在大多数情况下，导航时需要传递给应用程序的数据将包含在URL本身中，因此无论应用程序是否安装在设备上，用户都将看到正确的内容。 然而有时候应用程序会传送与应用间导航相关的资料，或是想利用应用程序使用的信息来修改App链接协议，以调整应用程序的行为（比如一个显示回引用应用程序的链接）。</p>
<p>如果你想要充分利用这些特性，你可以拆分导航过程。 首先，你必须拥有您要导航的应用程序链接：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> WebViewAppLinkResolver(getContext()).getAppLinkFromUrlInBackground(url).continueWith(</div><div class="line">    <span class="keyword">new</span> Continuation&lt;AppLink, AppLinkNavigation.NavigationType&gt;() &#123;</div><div class="line">      <span class="meta">@Override</span></div><div class="line">      <span class="keyword">public</span> AppLinkNavigation.<span class="function">NavigationType <span class="title">then</span><span class="params">(Task&lt;AppLink&gt; task)</span> </span>&#123;</div><div class="line">        AppLink link = task.getResult();</div><div class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">      &#125;</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<p>然后，你可以使用你想导航的附加数据构建一个APP Link请求：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Bundle extras = <span class="keyword">new</span> Bundle();</div><div class="line">extras.putString(<span class="string">"fb_access_token"</span>, <span class="string">"t0kEn"</span>);</div><div class="line">Bundle appLinkData = <span class="keyword">new</span> Bundle();</div><div class="line">appLinkData.putString(<span class="string">"id"</span>, <span class="string">"12345"</span>);</div><div class="line">AppLinkNavigation navigation = <span class="keyword">new</span> AppLinkNavigation(link, extras, appLinkData);</div><div class="line"><span class="keyword">return</span> navigation.navigate();</div></pre></td></tr></table></figure>
<h3 id="解决应用程序链接元数据"><a href="#解决应用程序链接元数据" class="headerlink" title="解决应用程序链接元数据"></a>解决应用程序链接元数据</h3><p>Bolts允许自定义App Link方案，可以用作性能优化（例如缓存元数据）或作为允许开发人员使用集中式索引来获得App Link元数据的机制。 一个自定义的App Link解析器只需要能够获取URL并返回一个包含适用于此设备的AppLink.Target的有序列表的AppLink。 Bolts创造性地提供了其中之一，使用隐藏的“WebView”在设备上执行此方案。</p>
<p>你可以重写<code>AppLinkNavigation</code>中的一个方法来使用任意的实现了<code>AppLinkResolver</code>接口的解析器：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">AppLinkNavigation.navigateInBackground(url, resolver);</div></pre></td></tr></table></figure>
<p>或者，你可以使用内置API替换掉默认的解析器：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">AppLinkNavigation.setDefaultResolver(resolver);</div><div class="line">AppLinkNavigation.navigateInBackground(url);</div></pre></td></tr></table></figure>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>Bolts介绍测量事件。 应用程序链接将两个Measurement Events广播到应用程序，该应用程序可以捕获并与应用程序中的现有分析组件集成。(启用Analytics需要<a href="http://developer.android.com/tools/support-library/index.html" target="_blank" rel="external">Android Support Library v4</a>)</p>
<ul>
<li><code>al_nav_out</code> — 当您的应用发送App链接URL时引发。</li>
<li><code>al_nav_in</code> — 当您的应用打开传入的应用链接Url或<code>Intent</code>时触发。</li>
</ul>
<h3 id="监听App链接测量事件"><a href="#监听App链接测量事件" class="headerlink" title="监听App链接测量事件"></a>监听App链接测量事件</h3><p>还有其他分析工具与Bolts的应用程序链接事件相集成，但你也可以自己收听这些事件：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">LocalBroadcastManager manager = LocalBroadcastManager.getInstance(context);</div><div class="line">manager.registerReceiver(</div><div class="line">    <span class="keyword">new</span> BroadcastReceiver() &#123;</div><div class="line">      <span class="meta">@Override</span></div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onReceive</span><span class="params">(Context context, Intent intent)</span> </span>&#123;</div><div class="line">        String eventName = intent.getStringExtra(MeasurementEvent.MEASUREMENT_EVENT_NAME_KEY);</div><div class="line">        <span class="keyword">if</span> (eventName.equals(MeasurementEvent.APP_LINK_NAVIGATE_IN_EVENT_NAME)) &#123;</div><div class="line">          Bundle eventArgs = intent.getBundleExtra(MeasurementEvent.MEASUREMENT_EVENT_ARGS_KEY);</div><div class="line">          String targetURL = eventArgs.getString(<span class="string">"targetURL"</span>);</div><div class="line">          String referrerName = eventArgs.getString(<span class="string">"refererAppName"</span>);</div><div class="line">          <span class="comment">// 继承你自己的 日志/分子 组件</span></div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="keyword">new</span> IntentFilter(MeasurementEvent.MEASUREMENT_EVENT_NOTIFICATION_NAME)</div><div class="line">);</div></pre></td></tr></table></figure>
<h3 id="应用链接事件字段"><a href="#应用链接事件字段" class="headerlink" title="应用链接事件字段"></a>应用链接事件字段</h3><p>应用程序链接测量事件以字符串键值对形式从应用程序链接Intent中发送附加信息。 下面是一些对两个事件的有用字段:</p>
<ul>
<li><p><code>al_nav_in</code></p>
<ul>
<li><code>inputURL</code>: 打开app的URL。</li>
<li><code>inputURLScheme</code>: <code>inputURL</code>的scheme。</li>
<li><code>refererURL</code>: 引用app添加进<code>al_applink_data</code>: <code>referer_app_link</code>的URL</li>
<li><code>refererAppName</code>: 引用app添加进<code>al_applink_data</code>: <code>referer_app_link</code>的名字.</li>
<li><code>sourceApplication</code>: 来源app的bundle</li>
<li><code>targetURL</code>: <code>al_applink_data</code>中的<code>target_url</code>字段.</li>
<li><code>version</code>: App Links API 版本.</li>
</ul>
</li>
<li><p><code>al_nav_out</code></p>
<ul>
<li><code>outputURL</code>: 用于打开其他应用程序（或浏览器）的URL。 如果有对应的的应用程序要打开，这将是“al_applink_data”中的自定义scheme的url / intent。</li>
<li><code>outputURLScheme</code>: <code>outputURL</code>的scheme。</li>
<li><code>sourceURL</code>: 应用程序链接meta标签中的页面URL</li>
<li><code>sourceURLHost</code>: sourceURL的host名字。</li>
<li><code>success</code>: “1”表示在其他应用程序或浏览器中打开应用程序链接成功; <code>“0”</code>表示无法打开App Link。</li>
<li><code>type</code>: <code>“app”</code>表示在应用程序中打开，<code>“web”</code>表示在浏览器中打开; <code>“fail”</code>表示成功字段为“0”`。</li>
<li><code>version</code>: App Links API版本。</li>
</ul>
</li>
</ul>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>如果您觉得这篇文章不错，可以打赏支持下哦，谢谢</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="Jadyli 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="Jadyli 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/year/09/22/java-javaee-小程序java后台-账户/" rel="next" title="小程序java后台-账户">
                <i class="fa fa-chevron-left"></i> 小程序java后台-账户
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/year/10/11/其他-Hexo搭建笔记/" rel="prev" title="Hexo搭建笔记">
                Hexo搭建笔记 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Jadyli</p>
              <p class="site-description motion-element" itemprop="description">三七的博客</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">41</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/Jadyli" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#下载"><span class="nav-number">1.</span> <span class="nav-text">下载</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Tasks"><span class="nav-number">2.</span> <span class="nav-text">Tasks</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#continueWith-方法"><span class="nav-number">2.1.</span> <span class="nav-text">continueWith 方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#链式任务"><span class="nav-number">2.2.</span> <span class="nav-text">链式任务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#错误处理"><span class="nav-number">2.3.</span> <span class="nav-text">错误处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建任务"><span class="nav-number">2.4.</span> <span class="nav-text">创建任务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建异步方法"><span class="nav-number">2.5.</span> <span class="nav-text">创建异步方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#顺序任务"><span class="nav-number">2.6.</span> <span class="nav-text">顺序任务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#并行任务"><span class="nav-number">2.7.</span> <span class="nav-text">并行任务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Task-Executors"><span class="nav-number">2.8.</span> <span class="nav-text">Task Executors</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#捕获变量"><span class="nav-number">2.9.</span> <span class="nav-text">捕获变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#取消Task"><span class="nav-number">2.10.</span> <span class="nav-text">取消Task</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#App-Links"><span class="nav-number">3.</span> <span class="nav-text">App Links</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#处理App-Link"><span class="nav-number">3.1.</span> <span class="nav-text">处理App Link</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#导航到一个url"><span class="nav-number">3.2.</span> <span class="nav-text">导航到一个url</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#添加应用和导航数据"><span class="nav-number">3.2.1.</span> <span class="nav-text">添加应用和导航数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#解决应用程序链接元数据"><span class="nav-number">3.2.2.</span> <span class="nav-text">解决应用程序链接元数据</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分析"><span class="nav-number">3.3.</span> <span class="nav-text">分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#监听App链接测量事件"><span class="nav-number">3.3.1.</span> <span class="nav-text">监听App链接测量事件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#应用链接事件字段"><span class="nav-number">3.3.2.</span> <span class="nav-text">应用链接事件字段</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1264747959'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s19.cnzz.com/z_stat.php%3Fid%3D1264747959%26show%3Dpic1' type='text/javascript'%3E%3C/script%3E"));</script>

<div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jadyli</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.3</div>






        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  

  

  

</body>
</html>
